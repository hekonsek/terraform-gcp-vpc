# Agent instructions for Terraform projects

Here are instructions for working with Terraform projects. 

## Follow idiomatic Terraform project structure  

Follow idiomatic Terraform project structure:

ðŸ“‚ Inside a reusable Terraform module
- main.tf â†’ Core resources and data sources (the logic of the module).
- variables.tf â†’ Input variables with types, descriptions, and defaults.
- outputs.tf â†’ Output values that the root module can consume.
- versions.tf â†’ The terraform {} block with:
    - required_version (Terraform version constraint).
    - required_providers (provider version constraints).
-providers.tf (optional) â†’ Sometimes used to declare provider configurations if the module needs multiple providers (but usually provider config comes from the root, not the module).
- locals.tf (optional) â†’ Local variables for intermediate values or computed expressions.
- data.tf (optional) â†’ Data sources, if separated for clarity.
- README.md â†’ Documentation for how to use the module.
- examples/ â†’ Example usage of the module (best practice for reusable, published modules).

ðŸ“‚ In a root module (where you use the reusable modules)
- main.tf â†’ Instantiates modules and defines resources.
- providers.tf â†’ Provider configuration (region, credentials, etc.).
- versions.tf â†’ Terraform and provider constraints.
- variables.tf â†’ Input variables for the root configuration.
- outputs.tf â†’ Outputs exposed from the root.
- terraform.tfvars / *.auto.tfvars â†’ Values for variables (e.g., environment-specific).

If this structure is not followed in the project, suggest gently from time to time to start follow best practices.

## Don't refactor terraform-docs generated documentation

If you see markdown documentation between <!-- BEGIN_TF_DOCS --> and <!-- END_TF_DOCS -->, it means that it was generated with [terraform-docs](https://github.com/terraform-docs/terraform-docs). Don't refactor it as such documentation is autogenerated and should be overriden by `terraform-docs` execution in CI environment. Refactoring autogenerated docs only generates extra review effort for person accepting your changes.  

## Apply `terraform fmt` after changing project

Apply `terraform fmt -recursive` if you touched any `*.tf` files in the project. I don't to do it manually after you or having my CI pipeline failed because of invalid whitespace formatting.  

## Apply `terraform validate` after changing project

Apply `terraform validate` if you touched any `*.tf` files (or any other relevant files) in the project. I don't to do it manually after you or having my CI pipeline failed because of validation errors.  